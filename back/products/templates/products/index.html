<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kakao Map with Vue</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        #map {
            width: 100%;
            height: 500px;
        }
    </style>
</head>
<body>
    <div id="app">
        <h1>Kakao Map</h1>
        <div id="map"></div>
    </div>

    <script>
        const { createApp, onMounted, ref } = Vue;

        createApp({
            setup() {
                const map = ref(null); // 지도 객체를 저장할 ref

                // Kakao Maps SDK 동적 로드
                const loadKakaoMapSDK = () => {
                    return new Promise((resolve, reject) => {
                        const script = document.createElement("script");
                        script.src = `https://dapi.kakao.com/v2/maps/sdk.js?appkey=${KAKAO_JS_KEY}&autoload=false`;
                        script.onload = () => resolve();
                        script.onerror = () => reject("Kakao Maps SDK 로드 실패");
                        document.head.appendChild(script);
                    });
                };

                // 지도 초기화 함수
                const initMap = () => {
                    kakao.maps.load(() => {
                        const mapContainer = document.querySelector("#map");
                        const mapOption = {
                            center: new kakao.maps.LatLng(37.5665, 126.9780), // 초기 중심좌표 (서울)
                            level: 3, // 확대/축소 수준
                        };
                        map.value = new kakao.maps.Map(mapContainer, mapOption); // 지도 생성
                    });
                };

                // 컴포넌트 마운트 시 Kakao 지도 초기화
                onMounted(async () => {
                    try {
                        await loadKakaoMapSDK(); // SDK 로드
                        initMap(); // 지도 초기화
                    } catch (error) {
                        console.error(error);
                    }
                });

                return {
                    map,
                };
            },
        }).mount("#app");
    </script>
</body>
</html>
